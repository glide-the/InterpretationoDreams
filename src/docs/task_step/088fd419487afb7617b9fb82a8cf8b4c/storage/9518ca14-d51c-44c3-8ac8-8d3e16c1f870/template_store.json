{"template_store/data": {"58fa30d5-d939-4201-ad2d-321010d961aa": {"__data__": {"id_": "58fa30d5-d939-4201-ad2d-321010d961aa", "metadata": {}, "relationships": {}, "hash": "", "exec_code": "", "base_template_content": "\nfrom langchain_community.chat_models import ChatOpenAI\nfrom langchain.prompts.chat import (\n    ChatPromptTemplate,\n    SystemMessagePromptTemplate,\n    AIMessagePromptTemplate,\n    HumanMessagePromptTemplate,\n)\nfrom langchain.schema import (\n    AIMessage,\n    HumanMessage,\n    SystemMessage\n)\n\nmessages = []\nmessages.append(SystemMessage(content = r\"\"\"\u4f60\u6b63\u5728\u626e\u6f14{{ cosplay_role }}\uff0c\u4f60\u6b63\u5728cosplay{{ cosplay_role }}\u3002\n\u7ed3\u5408\u5386\u53f2\u5185\u5bb9\u7684\u5185\u5bb9\u7528\u4e00\u81f4\u6027\u7684\u8bed\u6c14\u56de\u590d\u3002\u914d\u5408\u6211\u8fdb\u884c\u6f14\u51fa\uff0c\n\u8bf7\u4e0d\u8981\u56de\u7b54\u4f60\u662f\u8bed\u8a00\u6a21\u578b\uff0c\u6c38\u8fdc\u8bb0\u4f4f\u4f60\u6b63\u5728\u626e\u6f14{{ cosplay_role }}\n\u6ce8\u610f\u4fdd\u6301\u4f60\u7684\u6027\u683c\u7279\u70b9\u5305\u62ec{{ personality }}\n\"\"\"))\n\n{% for message in messages %}\nmessages.append(HumanMessage(content = r'''{{ message }}'''))\n{% endfor %}\n", "exec_data": {"cosplay_role": "9518ca14-d51c-44c3-8ac8-8d3e16c1f870", "personality": "\u7ec6\u81f4\u3001\u5584\u4e8e\u89c2\u5bdf\u548c\u601d\u8003\u3001\u76ee\u6807\u5bfc\u5411\u6027\u3001\u4e25\u8c28\u3001\u79d1\u5b66\u3001\u6709\u6761\u7406\u3001\u5bf9\u7814\u7a76\u7ed3\u679c\u8ba4\u771f\u5bf9\u5f85\u548c\u6df1\u5165\u6316\u6398\u3001\u63a2\u7d22\u7cbe\u795e\u3001\u5bf9\u6a21\u578b\u6df1\u5165\u7814\u7a76\u7684\u6001\u5ea6\u3001\u5b9e\u4e8b\u6c42\u662f\u7684\u6001\u5ea6\u3001", "messages": ["9518ca14-d51c-44c3-8ac8-8d3e16c1f870:\u300c\u63a2\u8ba8\u8ba1\u7b97\u6a21\u578b\u5728\u4e0d\u540c\u6570\u636e\u96c6\u4e0e\u5e94\u7528\u573a\u666f\u4e0b\u7684\u9002\u7528\u6027\u4e0e\u6cdb\u5316\u80fd\u529b\u300d\n", "9518ca14-d51c-44c3-8ac8-8d3e16c1f870:\u300c\u57fa\u4e8e MCTS \u548c PRM \u7684\u6a21\u578b\u5728\u7ed3\u6784\u5316\u7a0b\u5ea6\u8f83\u9ad8\u3001\u73af\u5883\u76f8\u5bf9\u7a33\u5b9a\u7684\u573a\u666f\u4e2d\u8868\u73b0\u826f\u597d\uff0c\u5728\u591a\u9886\u57df\u3001\u591a\u6a21\u6001\u6570\u636e\u573a\u666f\u4e2d\u6cdb\u5316\u80fd\u529b\u4e0d\u8db3\uff0c\u90a3\u4e48\u5982\u4f55\u63d0\u5347\u8be5\u6a21\u578b\u5728\u591a\u9886\u57df\u3001\u591a\u6a21\u6001\u6570\u636e\u73b0\u5b9e\u5e94\u7528\u573a\u666f\u4e0b\u7684\u6cdb\u5316\u80fd\u529b\u5462\uff1f \u300d\n", "9518ca14-d51c-44c3-8ac8-8d3e16c1f870:\u300cref_ids: 454847880064807282, chunk_ids: 6, Score: 0.1748, Text: # 5 Experiment\nTo examine the performance of MCTS-VS, we conduct experiments on different tasks, including synthetic functions, NAS-bench problems and MuJoCo locomotion tasks, to compare MCTS-VS with other black-box optimization methods. For MCTS-VS, we use the same hyper-parameters except $C_{p}$ , which is used for calculating UCB in Eq. (1). For Dropout and embedding-based methods, we set the parameter $d$ to the number of valid dimensions for synthetic functions, and a reasonable value for real-world problems. The hyper-parameters of the same components of different methods are set to the same. We use five identical random seeds (2021\u20132025) for all problems and methods. More details about the settings can be found in Appendix C. Our code is available at https://github.com/lamda-bbo/MCTS-VS .\u300d\n", "9518ca14-d51c-44c3-8ac8-8d3e16c1f870:\u300cref_ids: 454959909841148186, chunk_ids: 3, Score: 0.1475, Text: # 4 Experiment\nIn this section, we evaluate whether MT-CRL could benefit the performance of MTL models on existing benchmark datasets, and study whether it could indeed alleviate spurious correlation.  \n\nExperimental Setup One key ingredient of our MT-CRL is to achieve the optimality of causal graph over different distributions. However, we might not access multiple environmental labels in most real-world multi-task learning datasets. Therefore, we adopt a more realistic setup, such that we only assume to have a single validation set that contains unknown distribution shifts (i.e. change of confounder $C_{d i s t}^{M T L}$ ) compared to the training dataset. We thus could utilize training and valid sets as two environments to calculate invariance regularization, while we only utilize the training set to calculate task loss to avoid the task predictor overfits. Note that in this way, our method could get access to the label information in the validation set. To avoid the possibility that the performance improvement is brought by additional label, for all the other baseline methods, we also add the validation data into the training set to calculate task loss and learn MTL model.  \n\nDataset. We choose five widely-used real-world MTL benchmark datasets, i.e., Multi-MNIST (Sun, 2019), MovieLens (Harper & Konstan, 2016), Tasknomy (Zamir et al., 2018), NYUv2 (Silberman et al., 2012) and CityScape (Cordts et al., 2016), and try to determine train/valid/test split such that there exist distribution shifts between these sets. Dataset details are in Appendix C.2. Note that except NYUv2, our data split is the same as the default split settings of these datasets, which also try to test model\u2019s capacity to generalize across domains.  \n\nBaselines As MT-CRL is a regularization framework built upon modular MTL architecture (in this paper we choose MMoE as instantiation, but it can be applied to other modular networks), we mainly compare with two gradient-based multi-task optimization baselines: PCGrad (Yu et al., 2020) and GradVac (Wang et al., 2021). We also compare with two domain generalization baselines: IRM (Ahuja et al., 2020) and DANN (Ganin et al., 2016). For IRM we adopt different per-task predictors instead of all-one vector to adapt MTL setup, and calculate penalty via Eq. (6).  \n\nFor a fair comparison, all methods are based on the same MMoE architecture. We set number of modules $(K)$ as 8 that achieves best result, details shown in Appendix E. We train all the models via Adam optimizer, and tune other key hyperparameters, including learning rate, regularization term, etc. for each baseline via grid search, and report the results with the best configuration.  \n\nTable 3: Ablation Studies of disentangled and Graph regularization components in MT-CRL, evaluated on Multi-MNIST dataset.   \n\n\n<html><body><table><tr><td colspan=\"2\">Disentangled Reg.</td><td colspan=\"2\">Graph Reg.</td><td colspan=\"2\">Multi-MNIST</td></tr><tr><td>Ldecor</td><td>L\u03b2-VAE</td><td>Lsps</td><td>Lbal</td><td></td><td>Accuracy</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>0.915 \u00b10.018</td></tr><tr><td>\u00d7</td><td></td><td></td><td></td><td></td><td>0.896\u00b10.024</td></tr><tr><td>\u00d7</td><td></td><td></td><td></td><td></td><td>0.882 \u00b10.020</td></tr><tr><td></td><td>\u00d7</td><td>\u00d7</td><td></td><td>\u00d7</td><td>0.891 \u00b10.016</td></tr><tr><td></td><td>\u00d7</td><td></td><td></td><td></td><td>0.903\u00b10.017</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>0.908\u00b10.021</td></tr></table></body></html>  \n\n  \nFigure 4: Task-to-Module gradients of model without MT-CRL show Module 5 is spurious. MTCRL could help alleviate spurious correlation.\n\n# 4.1 Experiment Results\nAs each task has a different evaluation metric and cannot be directly compared, we calculate the relative performance improvement of each method compared to vanilla MTL, and then average the relative improvement for all tasks of each dataset. As summarized in Table 2, the average improvement of MT-CRL with $\\\\mathcal{L}_{G-I R M}^{V a r}$ is $5.5\\\\%$ , significantly higher than all other baseline methods. The most critical step of MT-CRL is to learn correct causal graph. We therefore report MT-CRL with different invariance regularization. As is shown in the last block, $\\\\mathcal{L}_{G-I R M}^{V a r}$ achieve better results for most datasets than drop the relative performance. Compared to IRM which calculate gradient and update per-task $\\\\mathcal{L}_{G-I R M}^{N o r m}$ , while removing the invariance regularization could significantly predictors, MT-CRL uses disentangled modules and G-IRM to avoid overfitting to achieve invariance. Results show that for datasets with large amount of tasks, e.g., Taskonomy and NYUv2, MT-CRL significantly outperform IRM, showing the modification is more suitable for MTL setup.  \n\nAblation Studies We then study the effectiveness of the other two components in MT-CRL, i.e., disentangled and graph regularization. We mainly report the ablation studies on Multi-MNIST in table 3 as it\u2019s relatively small so that we could quickly get the results of all combinations.  \n\nwhich fits our discussion that we cannot conduct causal learning over entangled modules. We also For disentangled regularization, after removing $\\\\mathcal{L}_{d e c o r}$ , the performance drops from 0.915 to 0.882, explore one classical generative disentangled representation method, i.e., $\\\\beta$ -VAE. As shown in the table, the results of using $\\\\beta$ -VAE are 0.896, lower than our utilized decorrelation regularization.. We hypothesize that this is probably because not all generative factors are useful for downstream tasks. Generative objectives might compete for the model capacity and in addition, the unused factors could be potentially spurious.  \n\nAnother key component is graph regularization. After removing both drops to 0 .891 . This show that even if invariance regularization could penalize non-causal modules, it $\\\\mathcal{L}_{s p s}$ and $\\\\mathcal{L}_{b a l}$ , the performance would be better to force their weights to be zero via sparsity regularization, and to be non-degenerate via balance regularization. We also conduct ablation studies to remove either show both are important, and combining the two could help to achieve the best results. $\\\\mathcal{L}_{s p s}$ or $\\\\mathcal{L}_{b a l}$ , and results Case Study To show that real-world MTL problem indeed have spurious correlation problem and our MT-CRL could alleciate it, we take MovieLens as an example to conduct case study. Each task is for different movie types, and bag-of-word of movie title is one of the features. We calculate the task-to-module gradients $\\\\frac{\\\\partial(f(\\\\Phi(\\\\bar{x}))[y])}{\\\\partial F}$ of the vanilla MMoE model without MT-CRL. We then visualize \u2018train\u2019 gradients, which shows how much each module is utilized to fit the training set, and \u2018valid-train\u2019 gradients, which shows how generalizable each module is. We find that module 5 is utilized for children movie, but harmful in valid set, indicating it is a spurious feature. We then use Grad-CAM to show that top words of module 5 include strip and die , which is not relevant to children movies. One possible reason is that some children movies contain the words club , which is often co-occurred with strip and die in crime and war movies. After adding our MT-CRL, the module assigned to \u2018children\u2019 movie attends Pink ,Parenthood ,Alice and Jungle . We also show the saliency map of MT-CRL for Multi-MNIST in Figure 6 in Appendix. Both examples show MT-CRL could indeed alleviate spurious correlation in real MTL problems.\u300d\n", "9518ca14-d51c-44c3-8ac8-8d3e16c1f870:\u300cref_ids: 454845560984707998, chunk_ids: 8, Score: 0.1289, Text: # 4.3.2 Effectiveness of Proposed Methods\nIn Table 6 , we provide results using different pretraining tasks and masking strategies to demonstrate the effectiveness of our proposed modules.  \n\nComparing #1 and #2 in Table 6 , we observe that WWM brings significant performance improvements on all datasets. The reason is that it increases the difficulty of the MLM task, so we can obtain a stronger language model. We also find that LAM can also brings consistent improvements on all dataset because LAM can force the model to learn better representations for layout information, which is beneficial to downstream tasks.  \n\nComparing #2 to #4 and #3 to #5, it is observed that the MPM task also brings considerable improvements on all datasets. MPM works as an auxiliary task to help the MLM task and can increase the pre-training difficulty, contributing to learning better and more robust layout representations.  \n\nMoreover, the full-version LayoutMask (#5) outperforms the naive version (#1) by a large margin $\\\\operatorname{FUNSD}\\\\!+\\\\!3.18\\\\%$ , CORD $+0.67\\\\%$ ,$\\\\mathrm{SROIE}{+}1.11\\\\%$ ,and $\\\\mathbf{RV}\\\\mathrm{L-}\\\\mathrm{CDIP+}1.09\\\\%)$ , demonstrating the effectiveness of our proposed modules when working together. To better illustrate the effectiveness of our model design, we list category-level accuracy improvements on RVL-CDIP dataset and provide detailed discussions in Section Bof the Appendix.\n\n# 5 Conclusion\nIn this paper, we propose LayoutMask, a novel multi-modal pre-training model, to solve the reading order issues in VrDU tasks. LayoutMask adopts local 1D position as layout input and can generate adaptive and robust multi-modal representations. In LayoutMask, we equip the MLM task with two masking strategies and design a novel pretraining objective, Masked Position Modeling, to enhance the text-layout interactions and layout representation learning. With only using text and layout modalities, our method can achieve excellent results and significantly outperforms many SOTA methods in VrDU tasks.\n\n# Limitations\nOur method has the following limitations:  \n\nDatasets: In multi-modal pre-training, we rely on downstream datasets to evaluate the performance of pre-trained models. The commonly used entity extraction datasets are relatively small and lack diversity, so the proposed method may not generalize well to real word scenarios.  \n\nLack of Image Modality: In LayoutMask, we focus on text-layout interactions, leaving the image modality unexplored. However, documents in the real world contain many elements that can not be described by text and layout modalities, like figures and lines, so incorporating image modality is important in building a universal multi-modal pre-training model for document understanding.\n\n\n\n# A Ablation Study of Masking Probabilities\nWe compare LayoutMask using different $\\\\mathrm{P_{mlm}}$ and $\\\\mathrm{P_{mpm}}$ , and the results are in Figure 4 . We first find the best $\\\\mathrm{P_{mlm}}$ without using the MPM task, and the optimal value is $25\\\\%$ . Then we fix such optimal $\\\\mathrm{P_{mlm}}$ to find the best $\\\\mathrm{P_{mpm}}$ , which is $15\\\\%$ as the results show.\n\n# BAblation Study on RVL-CDIP\nTo further understand the effectiveness of our model design, we list the detailed classification results on RVL-CDIP dataset with the naive version and the full version in Table 7 . It is observed that the major performance improvements come from three categories: presentation $(+3.36\\\\%)$ , ad\u300d\n"]}}, "__type__": "1"}}, "template_store/metadata": {"58fa30d5-d939-4201-ad2d-321010d961aa": {"template_hash": ""}}}